<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>项目计划管理系统</title>
    <link rel="icon" type="image/png" href="logo.png">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        secondary: '#2DD4BF',
                        success: '#00B42A',
                        warning: '#FF7D00',
                        danger: '#F53F3F',
                        gray: {
                            50: '#F7F8FA',
                            100: '#F2F3F5',
                            200: '#E5E6EB',
                            300: '#C9CDD4',
                            400: '#86909C',
                            500: '#4E5969',
                            600: '#272E3B',
                            700: '#1D2129',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    boxShadow: {
                        'card': '0 2px 12px 0 rgba(0, 0, 0, 0.08)',
                    }
                },
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .animate-fadeIn {
                animation: fadeIn 0.5s ease-in-out;
            }
            .scrollbar-hide::-webkit-scrollbar {
                display: none;
            }
            .scrollbar-hide {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }
            .table-fixed-layout {
                table-layout: fixed;
            }
        }
    </style>
</head>

<body class="bg-gray-50 min-h-screen flex flex-col">
    <!-- 左侧菜单栏 -->
    <aside id="sidebar"
        class="fixed left-0 top-0 h-full w-64 bg-white shadow-md z-40 transition-all duration-300 transform">
        <div class="flex items-center justify-between p-4 border-b border-gray-200">
            <div class="flex items-center space-x-2">
                <i class="fa fa-car text-primary text-2xl"></i>
                <h1 class="text-lg font-semibold text-gray-900">功能链管理系统</h1>
            </div>
            <button id="close-sidebar" class="md:hidden text-gray-500 hover:text-primary">
                <i class="fa fa-times"></i>
            </button>
        </div>

        <nav class="p-4">
            <!-- 主菜单 - 首页放在最上面 -->
            <div class="space-y-1 mb-4">
                <a href="index.html"
                    class="flex items-center py-2 px-3 text-gray-600 hover:text-primary hover:bg-gray-50 rounded-md transition-colors">
                    <i class="fa fa-home mr-3 text-gray-500"></i>
                    <span>首页</span>
                </a>
            </div>

            <!-- 申报菜单 -->
            <div class="mb-4">
                <div
                    class="flex items-center justify-between cursor-pointer hover:text-primary py-2 px-3 rounded-md hover:bg-gray-50 sidebar-parent-item">
                    <span class="flex items-center">
                        <i class="fa fa-file-text-o mr-3 text-gray-500"></i>
                        <span class="font-medium">申报</span>
                    </span>
                    <i class="fa fa-angle-down transition-transform duration-300 text-gray-500"></i>
                </div>
                <div class="ml-9 mt-2 space-y-2 sidebar-submenu hidden">
                    <a href="#"
                        class="block py-2 px-3 text-gray-600 hover:text-primary hover:bg-gray-50 rounded-md transition-colors">
                        <i class="fa fa-bullseye mr-3 text-gray-400"></i>目标
                    </a>
                    <a href="core_members.html"
                        class="block py-2 px-3 text-gray-600 hover:text-primary hover:bg-gray-50 rounded-md transition-colors">
                        <i class="fa fa-users mr-3 text-gray-400"></i>核心成员填报
                    </a>
                </div>
            </div>

            <!-- 中期工作计划填报菜单 -->
            <div class="mb-4">
                <div
                    class="flex items-center justify-between cursor-pointer hover:text-primary py-2 px-3 rounded-md hover:bg-gray-50 sidebar-parent-item">
                    <span class="flex items-center">
                        <i class="fa fa-calendar-check-o mr-3 text-gray-500"></i>
                        <span class="font-medium">中期工作计划填报</span>
                    </span>
                    <i class="fa fa-angle-down transition-transform duration-300 text-gray-500"></i>
                </div>
                <div class="ml-9 mt-2 space-y-2 sidebar-submenu hidden">
                    <a href="service_chain_manage.html"
                        class="block py-2 px-3 text-gray-600 hover:text-primary hover:bg-gray-50 rounded-md transition-colors">
                        <i class="fa fa-sitemap mr-3 text-gray-400"></i>服务链分析
                    </a>
                    <a href="tool_chain_manage.html"
                        class="block py-2 px-3 text-gray-600 hover:text-primary hover:bg-gray-50 rounded-md transition-colors">
                        <i class="fa fa-wrench mr-3 text-gray-400"></i>工具链分析
                    </a>
                    <a href="#"
                        class="block py-2 px-3 text-gray-600 hover:text-primary hover:bg-gray-50 rounded-md transition-colors">
                        <i class="fa fa-line-chart mr-3 text-gray-400"></i>业务推广计划
                    </a>
                    <a href="project_planning.html"
                        class="block py-2 px-3 text-primary bg-primary/5 rounded-md transition-colors">
                        <i class="fa fa-building-o mr-3 text-primary"></i>建设计划
                    </a>
                </div>
            </div>

            <!-- 考核情况填报菜单 -->
            <div class="mb-4">
                <div
                    class="flex items-center justify-between cursor-pointer hover:text-primary py-2 px-3 rounded-md hover:bg-gray-50 sidebar-parent-item">
                    <span class="flex items-center">
                        <i class="fa fa-tasks mr-3 text-gray-500"></i>
                        <span class="font-medium">考核情况填报</span>
                    </span>
                    <i class="fa fa-angle-down transition-transform duration-300 text-gray-500"></i>
                </div>
                <div class="ml-9 mt-2 space-y-2 sidebar-submenu hidden">
                    <a href="assessment.html"
                        class="block py-2 px-3 text-gray-600 hover:text-primary hover:bg-gray-50 rounded-md transition-colors">
                        <i class="fa fa-check-square-o mr-3 text-gray-400"></i>考核内容填报
                    </a>
                </div>
            </div>
        </nav>
    </aside>

    <!-- 顶部导航栏 -->
    <header class="fixed top-0 left-64 right-0 bg-white shadow-sm z-30 transition-all duration-300">
        <div class="w-full max-w-7xl mx-auto px-4">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <button id="toggle-sidebar" class="text-gray-500 hover:text-primary mr-4">
                        <i class="fa fa-bars"></i>
                    </button>
                    <div class="flex items-center space-x-2">
                        <span class="text-gray-500">中期工作计划填报</span>
                        <i class="fa fa-angle-right text-gray-400 text-xs"></i>
                        <span class="text-primary font-medium">建设计划</span>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <!-- 未读信息 -->
                    <div class="relative">
                        <button
                            class="p-2 text-gray-600 hover:text-primary rounded-full hover:bg-gray-100 transition-colors">
                            <i class="fa fa-bell text-xl"></i>
                            <span class="absolute top-1 right-1 w-2 h-2 bg-danger rounded-full"></span>
                        </button>
                    </div>

                    <!-- 当前登录用户 -->
                    <div class="flex items-center space-x-2 cursor-pointer hover:text-primary">
                        <img src="logo.png" alt="用户头像" class="w-8 h-8 rounded-full border-2 border-gray-200">
                        <span class="text-gray-700">张三</span>
                    </div>

                    <!-- 登出按钮 -->
                    <button onclick="logout()"
                        class="flex items-center space-x-1 px-3 py-1.5 text-gray-600 hover:text-primary hover:bg-gray-100 rounded-md transition-colors">
                        <i class="fa fa-sign-out"></i>
                        <span>登出</span>
                    </button>
                </div>
            </div>
        </div>
        <!-- 移动端菜单 -->
        <div class="md:hidden hidden bg-white border-t animate-fadeIn" id="mobile-menu">
            <div class="w-full max-w-7xl mx-auto px-4 py-2 flex flex-col space-y-3">
                <a href="index.html" class="py-3 px-2 rounded-md hover:bg-gray-50 hover:text-primary transition-all"><i
                        class="fa fa-home mr-2"></i> 首页</a>
            </div>
        </div>
    </header>


    <!-- 主内容区 -->
    <main class="flex-grow w-full max-w-7xl mx-auto px-4 pt-24 pb-12">
        <!-- 面包屑导航 -->
        <div class="flex items-center text-sm text-gray-500 mb-6">
            <a href="index.html" class="hover:text-primary transition-colors">首页</a>
            <i class="fa fa-angle-right mx-2 text-gray-400"></i>
            <span class="text-gray-700 font-medium">项目计划管理</span>
        </div>

        <!-- 标题和操作区 -->
        <div class="bg-white rounded-lg shadow-card p-6 mb-6 animate-fadeIn">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4">
                <div>
                    <h2 class="text-xl font-bold text-gray-900 mb-1">项目计划及时间节点管理</h2>
                    <p class="text-gray-500">管理各部门的项目计划、时间节点和交付成果</p>
                </div>
                <!-- 部门选择器 -->
                <div class="mt-4 md:mt-0 w-full md:w-auto">
                    <label class="block text-sm font-medium text-gray-700 mb-1">选择部门</label>
                    <div class="relative">
                        <select id="departmentSelect"
                            class="w-full md:w-48 px-3 py-2 pr-8 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary appearance-none bg-white">
                            <option value="all">全部部门</option>
                            <option value="功能链部门">功能链部门</option>
                        </select>
                        <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                            <i class="fa fa-chevron-down text-gray-400"></i>
                        </div>
                    </div>
                </div>
                <div class="mt-4 md:mt-0 flex flex-wrap gap-3 justify-center md:justify-end">
                    <button id="addCategoryBtn"
                        class="inline-flex items-center px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 transition-colors">
                        <i class="fa fa-plus mr-2"></i>添加类别
                    </button>
                    <button id="exportBtn"
                        class="inline-flex items-center px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition-colors">
                        <i class="fa fa-download mr-2"></i>导出数据
                    </button>
                    <div class="relative">
                        <input type="text" id="searchInput" placeholder="搜索计划内容..."
                            class="pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary">
                        <i class="fa fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- 计划表格区域 -->
        <div class="bg-white rounded-lg shadow-card p-6 mb-6 animate-fadeIn">
            <div class="overflow-x-auto">
                <div id="planningTableContainer"></div>
            </div>
        </div>
    </main>

    <!-- 页脚 -->
    <footer class="bg-white border-t py-6">
        <div class="container mx-auto px-4 text-center text-gray-500 text-sm">
            <p>© 2025 功能链管理系统. 保留所有权利.</p>
        </div>
    </footer>

    <!-- 添加类别模态框 -->
    <div id="addCategoryModal"
        class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-lg max-w-md w-full mx-4 animate-fadeIn">
            <div class="p-5 border-b">
                <h3 class="text-lg font-semibold text-gray-900">添加新类别</h3>
            </div>
            <div class="p-5">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">所属部门</label>
                    <select id="categoryDepartment"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary">
                        <option value="功能链部门">功能链部门</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">类别名称</label>
                    <input type="text" id="categoryName"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary"
                        placeholder="例如：项目设计">
                </div>
            </div>
            <div class="p-4 bg-gray-50 flex justify-end space-x-3 rounded-b-lg">
                <button id="cancelAddCategory"
                    class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors">取消</button>
                <button id="confirmAddCategory"
                    class="px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 transition-colors">确认添加</button>
            </div>
        </div>
    </div>

    <!-- 添加/编辑计划项模态框 -->
    <div id="editPlanModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-lg max-w-md w-full mx-4 animate-fadeIn">
            <div class="p-5 border-b">
                <h3 id="modalTitle" class="text-lg font-semibold text-gray-900">添加计划项</h3>
            </div>
            <div class="p-5">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">所属部门</label>
                    <select id="planDepartment"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary">
                        <option value="功能链部门">功能链部门</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">类别</label>
                    <select id="planCategory"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary">
                        <!-- 类别选项将动态生成 -->
                    </select>
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">序号</label>
                    <input type="number" id="planNumber"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary"
                        min="1">
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">时间（YYYY.MM）</label>
                    <input type="text" id="planDate"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary"
                        placeholder="例如：2025.09">
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">工作内容</label>
                    <textarea id="planContent" rows="3"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary"
                        placeholder="请输入工作内容"></textarea>
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">成果/交付物</label>
                    <input type="text" id="planDeliverable"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary"
                        placeholder="例如：CNAS能力表">
                </div>
                <input type="hidden" id="planId">
                <input type="hidden" id="isEditMode" value="false">
            </div>
            <div class="p-4 bg-gray-50 flex justify-end space-x-3 rounded-b-lg">
                <button id="cancelEditPlan"
                    class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors">取消</button>
                <button id="confirmEditPlan"
                    class="px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 transition-colors">保存</button>
            </div>
        </div>
    </div>

    <!-- 确认删除模态框 -->
    <div id="deleteConfirmModal"
        class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-lg max-w-md w-full mx-4 animate-fadeIn">
            <div class="p-5">
                <div class="flex items-center justify-center mb-4">
                    <div class="w-12 h-12 rounded-full bg-danger/10 flex items-center justify-center">
                        <i class="fa fa-exclamation-triangle text-danger text-xl"></i>
                    </div>
                </div>
                <h3 class="text-lg font-semibold text-center text-gray-900 mb-2">确认删除</h3>
                <p class="text-center text-gray-500 mb-4">您确定要删除这个计划项吗？此操作不可撤销。</p>
            </div>
            <div class="p-4 bg-gray-50 flex justify-center space-x-3 rounded-b-lg">
                <button id="cancelDelete"
                    class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors">取消</button>
                <button id="confirmDelete"
                    class="px-4 py-2 bg-danger text-white rounded-md hover:bg-danger/90 transition-colors">确认删除</button>
            </div>
        </div>
    </div>

    <script>
        // 初始化数据 - 按部门组织
        const departments = [
            { name: "功能链部门", id: "function_chain" }
        ];

        const projectData = [
            {
                department: "功能链部门",
                departmentId: "function_chain",
                category: "源媒（电解水制氢）",
                items: [
                    { id: "1-1", number: 1, date: "2025.9", content: "电解水制氢领域标准的CNAS检测认可资质扩项", deliverable: "CNAS能力表" },
                    { id: "1-2", number: 2, date: "2025.1", content: "电解水制氢设备测试台风险监测处置设备", deliverable: "设备实物" },
                    { id: "1-3", number: 3, date: "2025.11", content: "元章PEM电解槽租赁与设备能力建设", deliverable: "设备实物" },
                    { id: "1-4", number: 4, date: "2025.12", content: "电解水制氢业务开拓与执行", deliverable: "业务合同" }
                ]
            },
            {
                department: "功能链部门",
                departmentId: "function_chain",
                category: "储化（发电）",
                items: [
                    { id: "2-1", number: 1, date: "2025.6", content: "技术、商务标书编制", deliverable: "技术、商务标书" },
                    { id: "2-2", number: 2, date: "2025.7", content: "设备招投标及合同", deliverable: "招投标合同" },
                    { id: "2-3", number: 3, date: "2025.10", content: "设备制造及到货", deliverable: "/" },
                    { id: "2-4", number: 4, date: "2025.10", content: "设备安装及调试", deliverable: "/" },
                    { id: "2-5", number: 5, date: "2025.11", content: "设备验收", deliverable: "设备验收报告" },
                    { id: "2-6", number: 6, date: "2025.12", content: "项目验收", deliverable: "项目验收报告" }
                ]
            },
            {
                department: "功能链部门",
                departmentId: "function_chain",
                category: "储化（储氢）",
                items: [
                    { id: "3-1", number: 1, date: "2025.10", content: "氢储能领域相关标准扩项，GB/T 12137-2015气瓶气密性试验方法、GB/T 42536-2023车用高压储氢气瓶组合阀门", deliverable: "CNAS能力表" },
                    { id: "3-2", number: 2, date: "2026.6", content: "预冷能力方案和相应改造（共建模式）", deliverable: "设备实物" },
                    { id: "3-3", number: 3, date: "2026.10", content: "氢储能领域相关标准扩项，GB/T 42177-2022加氢站氢气阀门技术要求及试验方法的扩项", deliverable: "CNAS能力表" },
                    { id: "3-4", number: 4, date: "2027.1", content: "金属氢相容、渗透、氢脆能力建设到位（共建模式）", deliverable: "设备实物" },
                ]
            },
            {
                department: "功能链部门",
                departmentId: "function_chain",
                category: "储化（储电）",
                items: [
                    { id: "4-1", number: 1, date: "2026.12", content: "将实验室传统电池热安全测评体系化，同时根据固态电池发展趋势，适时建立相应测评能力", deliverable: "电池热安全综合测评能力" }
                ]
            },
            {
                department: "功能链部门",
                departmentId: "function_chain",
                category: "储化（关键材料）-待立项",
                items: [
                    { id: "5-1", number: 1, date: "2025.12", content: "完成仿真分析能力建设", deliverable: "仿真分析报告" },
                    { id: "5-2", number: 2, date: "2026.3", content: "联合科创平台共同搭建小样试制平台", deliverable: "小样试制elines" }
                ]
            },
            {
                department: "功能链部门",
                departmentId: "function_chain",
                category: "用端（船用测评领域）-待立项",
                items: [
                    { id: "6-1", number: 1, date: "2025.12", content: "梳理欠缺测试能力的工具链，形成建设方案", deliverable: "建设方案" },
                    { id: "6-2", number: 2, date: "2026.12", content: "基于已有车用燃料电池系统测试能力升级船用测试能力", deliverable: "测试案例" }
                ]
            },
            {
                department: "功能链部门",
                departmentId: "function_chain",
                category: "储化（低空经济）",
                items: [
                    { id: "7-1", number: 1, date: "2025.12", content: "形成燃料电池低空经济建设方案", deliverable: "建设方案" },
                    { id: "7-2", number: 2, date: "2026.3", content: "协同外部资源建设低空经济测试能力", deliverable: "应用案例" }
                ]
            },
            {
                department: "功能链部门",
                departmentId: "function_chain",
                category: "用端（氨醇内燃机建设）",
                items: [
                    { id: "8-1", number: 1, date: "2025.07", content: "1.土建、甲醇、氨气管路施工完成\n2.辅助设备安装调试", deliverable: "实验室建设完成" },
                    { id: "8-2", number: 2, date: "2025.09", content: "1.改造验收；承接甲醇内燃机试验；\n2.配置实验室测试人员，技术指导，培训计划；\n3.识别危险源分析，台架操作规程；\n4.安全管理文件、应急预案等", deliverable: "试验大纲、实验室管理文件" },
                    { id: "8-3", number: 3, date: "2025.12", content: "1.改造验收；承接氨氢内燃机试验；\n2.配置实验室测试人员，技术指导，培训计划；\n3.识别危险源分析，台架操作规程；\n4.安全管理文件、应急预案等", deliverable: "试验大纲、实验室管理文件" },
                    { id: "8-4", number: 4, date: "2026.04", content: "建成甲醇、氨氢内燃机性能开发、排放等研发测试能力", deliverable: "技术小结" },
                ]
            },
            {
                department: "功能链部门",
                departmentId: "function_chain",
                category: "用端（关键零部件软硬件能力的补充）",
                items: [
                    { id: "9-1", number: 1, date: "2025.12", content: "200kW功率级冷起动测试能力", deliverable: "设备实物" },
                    { id: "9-2", number: 2, date: "2025.12", content: "燃料电池堆性能-振动-环境\"三综合\"测试能力", deliverable: "设备实物" }
                ]
            },
            {
                department: "功能链部门",
                departmentId: "function_chain",
                category: "用端（燃料电池两轮车）",
                items: [
                    { id: "10-1", number: 1, date: "2025.09", content: "送审稿编制", deliverable: "送审稿" },
                    { id: "10-2", number: 2, date: "2025.12", content: "试验方法重复验证", deliverable: "验证试验" },
                    { id: "10-3", number: 3, date: "2026.06", content: "报批稿形成", deliverable: "报批稿" },
                    { id: "10-4", number: 4, date: "2026.12", content: "开展测试服务", deliverable: "测试案例" }
                ]
            }
        ];

        // 当前编辑或删除的计划项ID
        let currentPlanId = null;
        let currentCategory = null;
        let currentDepartment = null;

        // 根据选中的部门更新类别选择器
        function updateCategorySelect(department) {
            const categorySelect = document.getElementById('planCategory');
            categorySelect.innerHTML = '';

            // 获取指定部门的所有类别
            const categories = projectData
                .filter(item => department === 'all' || item.department === department)
                .map(item => item.category);

            // 去重
            const uniqueCategories = [...new Set(categories)];

            if (uniqueCategories.length === 0) {
                const option = document.createElement('option');
                option.value = '';
                option.textContent = '请先添加类别';
                categorySelect.appendChild(option);
            } else {
                uniqueCategories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category;
                    option.textContent = category;
                    categorySelect.appendChild(option);
                });
            }
        }

        // 更新部门选择器
        function updateDepartmentSelect() {
            const departmentSelect = document.getElementById('departmentSelect');
            const planDepartmentSelect = document.getElementById('planDepartment');
            const categoryDepartmentSelect = document.getElementById('categoryDepartment');

            // 获取现有部门选项
            const existingDepartments = new Set();
            departments.forEach(dept => existingDepartments.add(dept.name));

            // 查找数据中可能存在的新部门
            projectData.forEach(item => {
                if (!existingDepartments.has(item.department)) {
                    existingDepartments.add(item.department);
                    departments.push({ name: item.department, id: item.department.toLowerCase().replace(/\s+/g, '_') });
                }
            });

            // 更新部门选择器
            [departmentSelect, planDepartmentSelect, categoryDepartmentSelect].forEach(select => {
                if (select) {
                    // 保存当前选中的值
                    const currentValue = select.value;

                    // 清空并重新添加选项（保留"全部部门"选项）
                    if (select === departmentSelect) {
                        select.innerHTML = '<option value="all">全部部门</option>';
                    } else {
                        select.innerHTML = '';
                    }

                    departments.forEach(dept => {
                        const option = document.createElement('option');
                        option.value = dept.name;
                        option.textContent = dept.name;
                        select.appendChild(option);
                    });

                    // 恢复之前的选中值（如果存在）
                    if (currentValue && select.querySelector(`option[value="${currentValue}"]`)) {
                        select.value = currentValue;
                    }
                }
            });
        }

        // 添加新部门
        function addNewDepartment(departmentName) {
            if (!departments.some(dept => dept.name === departmentName)) {
                departments.push({
                    name: departmentName,
                    id: departmentName.toLowerCase().replace(/\s+/g, '_')
                });
                updateDepartmentSelect();
            }
        }

        // 渲染计划表格
        function renderPlanningTable(filterText = '', selectedDepartment = 'all') {
            const container = document.getElementById('planningTableContainer');
            let html = '';

            // 按部门和类别组织数据
            const groupedData = {};

            projectData.forEach(item => {
                // 过滤部门
                if (selectedDepartment !== 'all' && item.department !== selectedDepartment) {
                    return;
                }

                if (!groupedData[item.department]) {
                    groupedData[item.department] = {};
                }

                if (!groupedData[item.department][item.category]) {
                    groupedData[item.department][item.category] = [];
                }

                groupedData[item.department][item.category].push(item);
            });

            // 遍历部门
            Object.keys(groupedData).forEach(department => {
                const categories = groupedData[department];

                // 添加部门标题
                if (selectedDepartment === 'all') {
                    html += `
                        <div class="mb-12">
                            <div class="flex items-center mb-6">
                                <div class="h-6 w-1 bg-primary rounded-full mr-3"></div>
                                <h2 class="text-xl font-bold text-gray-800">${department}</h2>
                            </div>
                    `;
                }

                // 遍历该部门下的所有类别
                Object.keys(categories).forEach(category => {
                    const categoryData = categories[category][0]; // 获取类别数据

                    // 过滤该类别下的计划项
                    const filteredItems = filterText
                        ? categoryData.items.filter(item =>
                            item.content.toLowerCase().includes(filterText.toLowerCase()) ||
                            item.deliverable.toLowerCase().includes(filterText.toLowerCase()) ||
                            item.date.includes(filterText)
                        )
                        : categoryData.items;

                    // 如果过滤后该类别没有项目且有过滤条件，则跳过
                    if (filterText && filteredItems.length === 0) return;

                    html += `
                        <div class="mb-8 last:mb-0">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-lg font-semibold text-gray-900">${category}</h3>
                                <button class="add-item-btn inline-flex items-center px-3 py-1 bg-primary/10 text-primary rounded-md hover:bg-primary/20 transition-colors text-sm" 
                                        data-category="${category}" 
                                        data-department="${department}">
                                    <i class="fa fa-plus mr-1"></i>添加计划项
                                </button>
                            </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full border border-gray-200 rounded-lg">
                                <thead>
                                    <tr class="bg-gradient-to-r from-primary/5 to-gray-50">
                                        <th class="py-4 px-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wider border-b hover:bg-primary/10 transition-all duration-300">
                                            <div class="flex items-center">
                                                <i class="fa fa-hashtag text-primary mr-2"></i>
                                                序号
                                            </div>
                                        </th>
                                        <th class="py-4 px-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wider border-b hover:bg-primary/10 transition-all duration-300">
                                            <div class="flex items-center">
                                                <i class="fa fa-calendar-alt text-primary mr-2"></i>
                                                时间（YYYY.MM）
                                            </div>
                                        </th>
                                        <th class="py-4 px-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wider border-b hover:bg-primary/10 transition-all duration-300 min-w-[300px]">
                                            <div class="flex items-center">
                                                <i class="fa fa-tasks text-primary mr-2"></i>
                                                工作内容
                                            </div>
                                        </th>
                                        <th class="py-4 px-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wider border-b hover:bg-primary/10 transition-all duration-300 min-w-[200px]">
                                            <div class="flex items-center">
                                                <i class="fa fa-file-alt text-primary mr-2"></i>
                                                成果/交付物
                                            </div>
                                        </th>
                                        <th class="py-4 px-4 text-center text-sm font-semibold text-gray-700 uppercase tracking-wider border-b hover:bg-primary/10 transition-all duration-300 w-[100px]">
                                            <div class="flex items-center justify-center">
                                                <i class="fa fa-toolbox text-primary mr-2"></i>
                                                操作
                                            </div>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200">
                `;

                    if (filteredItems.length > 0) {
                        filteredItems.forEach(item => {
                            // 将多行文本转换为HTML换行
                            const formattedContent = item.content.replace(/\n/g, '<br>');

                            html += `
                            <tr class="hover:bg-gray-50 transition-colors">
                                <td class="py-3 px-4 text-sm text-gray-900">${item.number}</td>
                                <td class="py-3 px-4 text-sm text-gray-900">${item.date}</td>
                                <td class="py-3 px-4 text-sm text-gray-900 whitespace-pre-line">${formattedContent}</td>
                                <td class="py-3 px-4 text-sm text-gray-900">${item.deliverable}</td>
                                <td class="py-3 px-4 text-sm">
                                    <div class="flex justify-center space-x-2">
                                        <button class="edit-btn text-primary hover:text-primary/80 transition-colors" 
                                                data-id="${item.id}" 
                                                data-category="${category}" 
                                                data-department="${department}">
                                            <i class="fa fa-edit"></i>
                                        </button>
                                        <button class="delete-btn text-danger hover:text-danger/80 transition-colors" 
                                                data-id="${item.id}" 
                                                data-category="${category}" 
                                                data-department="${department}">
                                            <i class="fa fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        `;
                        });
                    } else {
                        html += `
                        <tr>
                            <td colspan="5" class="py-8 text-center text-gray-500">
                                <i class="fa fa-search-minus text-2xl mb-2"></i>
                                <p>未找到匹配的计划项</p>
                            </td>
                        </tr>
                    `;
                    }

                    html += `
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;
                });

                if (selectedDepartment === 'all') {
                    html += '</div>'; // 关闭部门容器
                }
            });

            // 如果没有数据，显示空状态
            if (html === '') {
                html = `
                    <div class="py-16 text-center">
                        <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-gray-100 mb-4">
                            <i class="fa fa-calendar-alt text-gray-400 text-2xl"></i>
                        </div>
                        <h3 class="text-lg font-medium text-gray-900 mb-2">暂无计划数据</h3>
                        <p class="text-gray-500 mb-6">${selectedDepartment === 'all' ? '所有部门' : selectedDepartment}还没有添加任何计划</p>
                        <button id="emptyAddBtn" class="inline-flex items-center px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 transition-colors">
                            <i class="fa fa-plus mr-2"></i>添加第一个计划
                        </button>
                    </div>
                `;
            }

            container.innerHTML = html;

            // 绑定空状态下的添加按钮事件
            const emptyAddBtn = document.getElementById('emptyAddBtn');
            if (emptyAddBtn) {
                emptyAddBtn.addEventListener('click', function () {
                    document.getElementById('addCategoryModal').classList.remove('hidden');
                });
            }

            // 绑定添加计划项按钮事件
            document.querySelectorAll('.add-item-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    const category = this.getAttribute('data-category');
                    const department = this.getAttribute('data-department');
                    openAddPlanModal(category, department);
                });
            });

            // 绑定编辑按钮事件
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    const id = this.getAttribute('data-id');
                    const category = this.getAttribute('data-category');
                    const department = this.getAttribute('data-department');
                    openEditPlanModal(id, category, department);
                });
            });

            // 绑定删除按钮事件
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    const id = this.getAttribute('data-id');
                    const category = this.getAttribute('data-category');
                    const department = this.getAttribute('data-department');
                    openDeleteConfirmModal(id, category, department);
                });
            });
        }

        // 打开添加计划项模态框
        function openAddPlanModal(category, department) {
            document.getElementById('modalTitle').textContent = '添加计划项';
            document.getElementById('planDepartment').value = department || '功能链部门';
            updateCategorySelect(department || '功能链部门');
            document.getElementById('planCategory').value = category || '';
            document.getElementById('planNumber').value = '';
            document.getElementById('planDate').value = '';
            document.getElementById('planContent').value = '';
            document.getElementById('planDeliverable').value = '';
            document.getElementById('planId').value = '';
            document.getElementById('isEditMode').value = 'false';

            // 计算新计划项的序号
            const categoryData = projectData.find(c => c.category === category && c.department === department);
            if (categoryData) {
                const maxNumber = Math.max(...categoryData.items.map(item => item.number), 0);
                document.getElementById('planNumber').value = maxNumber + 1;
            } else {
                document.getElementById('planNumber').value = 1;
            }

            // 绑定部门变化事件
            document.getElementById('planDepartment').onchange = function () {
                updateCategorySelect(this.value);
            };

            document.getElementById('editPlanModal').classList.remove('hidden');
        }

        // 打开编辑计划项模态框
        function openEditPlanModal(id, category, department) {
            const categoryData = projectData.find(c => c.category === category && c.department === department);
            if (!categoryData) return;

            const item = categoryData.items.find(i => i.id === id);
            if (!item) return;

            document.getElementById('modalTitle').textContent = '编辑计划项';
            document.getElementById('planDepartment').value = department;
            updateCategorySelect(department);
            document.getElementById('planCategory').value = category;
            document.getElementById('planNumber').value = item.number;
            document.getElementById('planDate').value = item.date;
            document.getElementById('planContent').value = item.content;
            document.getElementById('planDeliverable').value = item.deliverable;
            document.getElementById('planId').value = item.id;
            document.getElementById('isEditMode').value = 'true';

            // 绑定部门变化事件
            document.getElementById('planDepartment').onchange = function () {
                updateCategorySelect(this.value);
            };

            currentPlanId = id;
            currentCategory = category;
            currentDepartment = department;

            document.getElementById('editPlanModal').classList.remove('hidden');
        }

        // 打开删除确认模态框
        function openDeleteConfirmModal(id, category, department) {
            currentPlanId = id;
            currentCategory = category;
            currentDepartment = department;
            document.getElementById('deleteConfirmModal').classList.remove('hidden');
        }

        // 保存计划项（添加或编辑）
        function savePlanItem() {
            const department = document.getElementById('planDepartment').value;
            const category = document.getElementById('planCategory').value;
            const number = parseInt(document.getElementById('planNumber').value, 10);
            const date = document.getElementById('planDate').value;
            const content = document.getElementById('planContent').value;
            const deliverable = document.getElementById('planDeliverable').value;
            const isEditMode = document.getElementById('isEditMode').value === 'true';
            const planId = document.getElementById('planId').value;

            // 验证必填字段
            if (!department || !category || !number || !date || !content) {
                alert('请填写必填字段：部门、类别、序号、时间和工作内容');
                return;
            }

            // 确保部门存在
            addNewDepartment(department);

            // 查找或创建类别
            let categoryData = projectData.find(c => c.category === category && c.department === department);
            if (!categoryData) {
                categoryData = {
                    department: department,
                    departmentId: department.toLowerCase().replace(/\s+/g, '_'),
                    category: category,
                    items: []
                };
                projectData.push(categoryData);

                // 更新类别选择器
                updateCategorySelect(department);
            }

            // 获取当前选中的部门筛选器值
            const selectedDepartment = document.getElementById('departmentSelect').value;

            if (isEditMode) {
                // 如果部门或类别发生变化，需要在旧位置删除并在新位置添加
                if (department !== currentDepartment || category !== currentCategory) {
                    // 从旧位置删除
                    const oldCategoryData = projectData.find(c => c.category === currentCategory && c.department === currentDepartment);
                    if (oldCategoryData) {
                        const oldIndex = oldCategoryData.items.findIndex(item => item.id === planId);
                        if (oldIndex !== -1) {
                            oldCategoryData.items.splice(oldIndex, 1);

                            // 如果旧类别为空，删除该类别
                            if (oldCategoryData.items.length === 0) {
                                const categoryIndex = projectData.findIndex(c => c.category === currentCategory && c.department === currentDepartment);
                                if (categoryIndex !== -1) {
                                    projectData.splice(categoryIndex, 1);
                                }
                            }
                        }
                    }

                    // 在新位置添加
                    const newId = `${projectData.indexOf(categoryData) + 1}-${categoryData.items.length + 1}`;
                    categoryData.items.push({
                        id: newId, // 使用新ID避免冲突
                        number: number,
                        date: date,
                        content: content,
                        deliverable: deliverable
                    });
                } else {
                    // 编辑现有计划项
                    const index = categoryData.items.findIndex(item => item.id === planId);
                    if (index !== -1) {
                        categoryData.items[index] = {
                            id: planId,
                            number: number,
                            date: date,
                            content: content,
                            deliverable: deliverable
                        };
                    }
                }
            } else {
                // 添加新计划项
                const newId = `${projectData.indexOf(categoryData) + 1}-${categoryData.items.length + 1}`;
                categoryData.items.push({
                    id: newId,
                    number: number,
                    date: date,
                    content: content,
                    deliverable: deliverable
                });
            }

            // 按序号排序
            categoryData.items.sort((a, b) => a.number - b.number);

            // 重新渲染表格
            renderPlanningTable(document.getElementById('searchInput').value, selectedDepartment);

            // 关闭模态框
            document.getElementById('editPlanModal').classList.add('hidden');
        }

        // 删除计划项
        function deletePlanItem() {
            const categoryData = projectData.find(c => c.category === currentCategory && c.department === currentDepartment);
            if (!categoryData) return;

            const index = categoryData.items.findIndex(item => item.id === currentPlanId);
            if (index !== -1) {
                categoryData.items.splice(index, 1);

                // 如果类别为空，考虑是否删除类别
                if (categoryData.items.length === 0) {
                    const categoryIndex = projectData.findIndex(c => c.category === currentCategory && c.department === currentDepartment);
                    if (categoryIndex !== -1) {
                        projectData.splice(categoryIndex, 1);
                    }
                }

                // 重新渲染表格
                renderPlanningTable(document.getElementById('searchInput').value, document.getElementById('departmentSelect').value);

                // 关闭模态框
                document.getElementById('deleteConfirmModal').classList.add('hidden');
            }
        }

        // 添加新类别
        function addNewCategory() {
            const department = document.getElementById('categoryDepartment').value;
            const categoryName = document.getElementById('categoryName').value.trim();

            if (!department) {
                alert('请选择所属部门');
                return;
            }

            if (!categoryName) {
                alert('请输入类别名称');
                return;
            }

            // 检查类别是否已存在（在同一部门下）
            if (projectData.some(c => c.category === categoryName && c.department === department)) {
                alert('该部门下已存在此类别');
                return;
            }

            // 确保部门存在
            addNewDepartment(department);

            // 添加新类别
            projectData.push({
                department: department,
                departmentId: department.toLowerCase().replace(/\s+/g, '_'),
                category: categoryName,
                items: []
            });

            // 更新类别选择器
            updateDepartmentSelect();

            // 重新渲染表格
            renderPlanningTable(document.getElementById('searchInput').value, document.getElementById('departmentSelect').value);

            // 关闭模态框
            document.getElementById('addCategoryModal').classList.add('hidden');
            document.getElementById('categoryName').value = '';
        }

        // 导出数据
        function exportData() {
            const data = [];
            const selectedDepartment = document.getElementById('departmentSelect').value;

            projectData.forEach(category => {
                // 如果选择了特定部门，则只导出该部门的数据
                if (selectedDepartment !== 'all' && category.department !== selectedDepartment) {
                    return;
                }

                category.items.forEach(item => {
                    data.push({
                        部门: category.department,
                        类别: category.category,
                        序号: item.number,
                        时间: item.date,
                        工作内容: item.content,
                        成果交付物: item.deliverable
                    });
                });
            });

            if (data.length === 0) {
                alert('没有可导出的数据');
                return;
            }

            // 转换为CSV
            const headers = Object.keys(data[0]);
            const csvRows = [];

            // 添加表头
            csvRows.push(headers.join(','));

            // 添加数据行
            for (const row of data) {
                const values = headers.map(header => {
                    const value = row[header];
                    // 如果值包含逗号或换行符，用引号包裹
                    if (typeof value === 'string' && (value.includes(',') || value.includes('\n'))) {
                        return `"${value.replace(/"/g, '""')}"`;
                    }
                    return value;
                });
                csvRows.push(values.join(','));
            }

            const csvString = csvRows.join('\n');
            const blob = new Blob([csvString], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);

            link.setAttribute('href', url);
            const departmentLabel = selectedDepartment === 'all' ? '全部部门' : selectedDepartment;
            link.setAttribute('download', `项目计划_${departmentLabel}_${new Date().toLocaleDateString()}.csv`);
            link.style.visibility = 'hidden';

            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // 初始化事件监听器
        function initEventListeners() {
            // 移动端菜单切换
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            if (mobileMenuBtn) {
                mobileMenuBtn.addEventListener('click', function () {
                    const mobileMenu = document.getElementById('mobile-menu');
                    if (mobileMenu) {
                        mobileMenu.classList.toggle('hidden');
                    }
                });
            }

            // 添加类别按钮
            const addCategoryBtn = document.getElementById('addCategoryBtn');
            if (addCategoryBtn) {
                addCategoryBtn.addEventListener('click', function () {
                    updateDepartmentSelect();
                    const addCategoryModal = document.getElementById('addCategoryModal');
                    if (addCategoryModal) {
                        addCategoryModal.classList.remove('hidden');
                    }
                });
            }

            // 取消添加类别
            const cancelAddCategory = document.getElementById('cancelAddCategory');
            if (cancelAddCategory) {
                cancelAddCategory.addEventListener('click', function () {
                    const addCategoryModal = document.getElementById('addCategoryModal');
                    const categoryName = document.getElementById('categoryName');
                    if (addCategoryModal) {
                        addCategoryModal.classList.add('hidden');
                    }
                    if (categoryName) {
                        categoryName.value = '';
                    }
                });
            }

            // 确认添加类别
            const confirmAddCategory = document.getElementById('confirmAddCategory');
            if (confirmAddCategory) {
                confirmAddCategory.addEventListener('click', addNewCategory);
            }

            // 取消编辑计划
            const cancelEditPlan = document.getElementById('cancelEditPlan');
            if (cancelEditPlan) {
                cancelEditPlan.addEventListener('click', function () {
                    const editPlanModal = document.getElementById('editPlanModal');
                    if (editPlanModal) {
                        editPlanModal.classList.add('hidden');
                    }
                });
            }

            // 确认编辑计划
            const confirmEditPlan = document.getElementById('confirmEditPlan');
            if (confirmEditPlan) {
                confirmEditPlan.addEventListener('click', savePlanItem);
            }

            // 取消删除
            const cancelDelete = document.getElementById('cancelDelete');
            if (cancelDelete) {
                cancelDelete.addEventListener('click', function () {
                    const deleteConfirmModal = document.getElementById('deleteConfirmModal');
                    if (deleteConfirmModal) {
                        deleteConfirmModal.classList.add('hidden');
                    }
                });
            }

            // 确认删除
            const confirmDelete = document.getElementById('confirmDelete');
            if (confirmDelete) {
                confirmDelete.addEventListener('click', deletePlanItem);
            }

            // 导出按钮
            const exportBtn = document.getElementById('exportBtn');
            if (exportBtn) {
                exportBtn.addEventListener('click', exportData);
            }

            // 搜索功能
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('input', function () {
                    const departmentSelect = document.getElementById('departmentSelect');
                    const selectedDepartment = departmentSelect ? departmentSelect.value : '';
                    renderPlanningTable(this.value, selectedDepartment);
                });
            }

            // 部门筛选功能
            const departmentSelect = document.getElementById('departmentSelect');
            if (departmentSelect) {
                departmentSelect.addEventListener('change', function () {
                    const searchInput = document.getElementById('searchInput');
                    const searchText = searchInput ? searchInput.value : '';
                    renderPlanningTable(searchText, this.value);

                    // 如果正在添加或编辑计划，也更新部门选择器
                    updateCategorySelect(this.value);
                });
            }

            // 点击模态框外部关闭
            window.addEventListener('click', function (event) {
                const modals = ['addCategoryModal', 'editPlanModal', 'deleteConfirmModal'];
                modals.forEach(modalId => {
                    const modal = document.getElementById(modalId);
                    if (!modal) return;
                    if (event.target === modal) {
                        modal.classList.add('hidden');
                    }
                });
            });

            // ESC键关闭模态框
            document.addEventListener('keydown', function (event) {
                if (event.key === 'Escape') {
                    const modals = ['addCategoryModal', 'editPlanModal', 'deleteConfirmModal'];
                    modals.forEach(modalId => {
                        const modal = document.getElementById(modalId);
                        if (!modal) return;
                        if (!modal.classList.contains('hidden')) {
                            modal.classList.add('hidden');
                        }
                    });
                }
            });
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function () {
            updateDepartmentSelect();
            updateCategorySelect('功能链部门');
            initEventListeners();
            renderPlanningTable();
        });
    </script>

    <script>
        // 侧边栏菜单展开/折叠
        document.addEventListener('DOMContentLoaded', function () {
            // 侧边栏菜单展开/折叠
            const parentItems = document.querySelectorAll('.sidebar-parent-item');
            parentItems.forEach(item => {
                item.addEventListener('click', function () {
                    const submenu = this.nextElementSibling;
                    const icon = this.querySelector('.fa-angle-down');

                    // 切换当前子菜单
                    if (submenu && submenu.classList.contains('sidebar-submenu')) {
                        submenu.classList.toggle('hidden');
                        icon.style.transform = submenu.classList.contains('hidden') ? 'rotate(0deg)' : 'rotate(180deg)';
                    }
                });
            });

            // 调整主内容区域的padding-left
            const mainContent = document.querySelector('main');
            if (mainContent) {
                mainContent.style.paddingLeft = '272px'; // 64px + 16px
            }

            // 初始化事件监听器
            initEventListeners();

            // 移动端侧边栏处理
            const menuToggle = document.getElementById('menu-toggle');
            const closeSidebar = document.getElementById('close-sidebar');
            const sidebar = document.getElementById('sidebar');

            if (menuToggle && sidebar) {
                menuToggle.addEventListener('click', function () {
                    sidebar.classList.toggle('-translate-x-full');
                });
            }

            if (closeSidebar && sidebar) {
                closeSidebar.addEventListener('click', function () {
                    sidebar.classList.add('-translate-x-full');
                });
            }
        });
    </script>
</body>

</html>